= Lab Guide: Creating Multiple Job Templates
:notoc:
:toc-title: Table of Contents
:nosectnums:
:icons: font

_A guide to creating a second and third Job Template to run different playbooks from your projects._

---

== Lab Briefing

In the automation controller, **job templates** are a visual representation of the `ansible-playbook` command and all the flags you can use when executing from the command line. They are the primary mechanism for running your Ansible Playbooks.

image::../assets/images/job-templates-home-with-example-job-template.png[Job Templates list view in automation controller, opts="border"]

---

== Lab Guide: Hands-On Tasks

Let's use what you learned previously to create a second and third **Job Template**.

* Your second Job Template, `Extended services`, will use the `extended_services.yml` playbook to deploy a PostgreSQL database to `node3`.
* Your third Job Template, `Set motd`, will use the `motd_facts.yml` playbook to set a message of the day on `node1`.

NOTE: This exercise demonstrates how you can use different playbooks from the same Project in multiple Job Templates.

[IMPORTANT]
====
Reminder that the credentials to log in to the automation controller are:

* *Username:* `admin`
* *Password:* `ansible123!`
====

=== Task 1: Create the "Extended Services" Job Template

First, you will create the job template to deploy the database.

. **Navigate to the Templates page.**
+
In the left navigation menu, go to **Automation Execution** â†’ **Templates**.

. **Create a new job template.**
+
**Click** the blue **Create template** button and select **Create job template**.

. **Enter the job template details.**
+
Fill out the form with the following information:
+
* **Name:** `Extended services`
* **Job Type:** `Run`
* **Inventory:** `Lab-Inventory`
* **Project:** `Additional playbooks`
* **Playbook:** `extended_services.yml`
* **Credentials:** Select `lab-credentials`.
* **Privilege Escalation:** **Check** this box to enable `become`.

. **Save the job template.**
+
Leave all other fields as they are and **click** the blue **Create job template** button.

[IMPORTANT]
====
Remember to set the **Credentials** field. It's not a mandatory field in the UI, but if you don't select the correct machine credentials, the job will fail.
====

=== Task 2: Launch the "Extended Services" Job Template

Now, launch the template and troubleshoot the expected failure.

. **Launch the template.**
+
Navigate to the **Templates** page and **click** the **Launch** icon (ðŸš€) next to the `Extended services` job template.

. **Observe and resolve the failure.**
+
The job execution will **fail**. Read the output message to understand why. The playbook is trying to run on a host named `node3` in a group named `[database]`, but neither of these exist in your `Lab-Inventory`.

. **Update the inventory.**
+
Using what you learned in the inventory challenge, go back to your `Lab-Inventory` and perform the following actions:
+
--
* **Create** a new host named `node3`.
* **Create** a new group named `database`.
* **Add** the `node3` host to the `database` group.
--

. **Relaunch the job.**
+
**Launch** the `Extended services` job template again and verify that it now succeeds.

=== Task 3: Create the "Set motd" Job Template

Now, apply what you've learned to create the third job template.

. **Navigate to the Templates page.**
+
Go to **Automation Execution** â†’ **Templates**.

. **Create a new job template.**
+
**Click** the **Create template** button and select **Create job template**.

. **Enter the job template details.**
+
Fill out the form with the following information:
+
* **Name:** `Set motd`
* **Inventory:** `Lab-Inventory`
* **Project:** `Additional playbooks`
* **Playbook:** `motd_facts.yml`
* **Credentials:** Select `lab-credentials`.
* **Privilege Escalation:** **Check** this box.

. **Save the job template.**
+
**Click** the blue **Create job template** button.

=== Task 4: Launch the "Set motd" Job Template

Finally, launch the new template to set the message of the day.

. **Launch the template.**
+
From the **Templates** list, **click** the **Launch** icon (ðŸš€) next to the `Set motd` job template.

. **Verify the execution was successful.**
+
The job should complete with a **Successful** status.

---

== Next Steps

Press the `Check` button below to proceed to the next challenge.

== Troubleshooting

If you have encountered an issue or have noticed something not quite right, please link:https://github.com/ansible/instruqt/issues/new?labels=controller-101&title=controller-101+slug+ID:+controller-101-template-extended&assignees=leogallego[open an issue on GitHub].
